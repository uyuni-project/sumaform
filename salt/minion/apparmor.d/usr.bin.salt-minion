# Last Modified: Wed Mar 28 14:29:58 2018
#include <tunables/global>

/usr/bin/salt-minion {
  #include <abstractions/base>
  #include <abstractions/python>


  capability dac_override,
  capability net_admin,
  capability sys_ptrace,
  capability syslog,

  network inet dgram,


  /bin/bash rix,
  /dev/kmsg r,
  /dev/shm/* rw,
  /dev/tty rw,
  /etc/ r,
  /etc/SuSE-release r,
  /etc/default/nss r,
  /etc/group r,
  /etc/host.conf r,
  /etc/hosts r,
  /etc/iproute2/group r,
  /etc/machine-id r,
  /etc/nsswitch.conf r,
  /etc/os-release r,
  /etc/passwd r,
  /etc/resolv.conf r,
  /etc/salt/grains r,
  /etc/salt/minion r,
  /etc/salt/minion.d/ r,
  /etc/salt/minion_id r,
  /etc/salt/pki/minion/ r,
  /etc/shells r,
  /etc/ssl/openssl.cnf r,
  /proc/*/cgroup r,
  /proc/*/environ r,
  /proc/*/mounts r,
  /proc/*/stat r,
  /proc/*/status r,
  /proc/cmdline r,
  /proc/filesystems r,
  /proc/meminfo r,
  /proc/sys/crypto/fips_enabled r,
  /run/salt-minion.pid rw,
  /run/salt/minion/ r,
  /run/salt/minion/minion_event_*_pub.ipc w,
  /run/salt/minion/minion_event_*_pull.ipc w,
  /sbin/ldconfig rix,
  /sys/block/ r,
  /sys/bus/xen/drivers/ r,
  /sys/devices/**/queue/rotational r,
  /sys/devices/virtual/dmi/id/bios_date r,
  /sys/devices/virtual/dmi/id/bios_version r,
  /sys/devices/virtual/dmi/id/product_name r,
  /sys/devices/virtual/dmi/id/product_serial r,
  /sys/devices/virtual/dmi/id/product_uuid r,
  /sys/devices/virtual/dmi/id/sys_vendor r,
  /usr/bin/dmesg rix,
  /usr/bin/kmod rix,
  /usr/bin/python2.7 ix,
  /usr/bin/salt-minion r,
  /usr/bin/systemctl rix,
  /usr/bin/systemd-detect-virt rix,
  /usr/bin/systemd-notify rix,
  /usr/bin/which rix,
  /usr/sbin/ip rix,
  /var/cache/salt/minion/ r,
  /var/cache/salt/minion/accumulator/ r,
  /var/cache/salt/minion/extmods/ r,
  /var/cache/salt/minion/file_lists/ r,
  /var/cache/salt/minion/file_lists/roots/ r,
  /var/cache/salt/minion/files/ r,
  /var/cache/salt/minion/files/base/ r,
  /var/cache/salt/minion/files/base/client/ r,
  /var/cache/salt/minion/files/base/client/repos.d/ r,
  /var/cache/salt/minion/files/base/default/ r,
  /var/cache/salt/minion/files/base/default/repos.d/ r,
  /var/cache/salt/minion/files/base/minion/ r,
  /var/cache/salt/minion/files/base/minion/certs/ r,
  /var/cache/salt/minion/files/base/minion/repos.d/ r,
  /var/cache/salt/minion/proc/ r,
  /var/cache/salt/minion/roots/ r,
  /var/cache/salt/minion/roots/hash/ r,
  /var/cache/salt/minion/roots/hash/base/ r,
  /var/cache/salt/minion/roots/hash/base/client/ r,
  /var/cache/salt/minion/roots/hash/base/client/repos.d/ r,
  /var/cache/salt/minion/roots/hash/base/default/ r,
  /var/cache/salt/minion/roots/hash/base/default/repos.d/ r,
  /var/cache/salt/minion/roots/hash/base/minion/ r,
  /var/cache/salt/minion/roots/hash/base/minion/certs/ r,
  /var/cache/salt/minion/roots/hash/base/minion/repos.d/ r,
  /var/lib/ca-certificates/ca-bundle.pem r,
  /var/log/salt/minion w,

}
